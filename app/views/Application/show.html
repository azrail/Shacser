#{extends 'main.html' /}
#{set title:post.title /}

#{if flash.success}
<p class="success">
	${flash.success}
</p>
#{/if}

#{display post:post, as:'full' /}

<h3>Schreibe einen Kommentar</h3>
<div class="form">

	<form action="@{Application.postComment(post.id)}" method="post" id="contactform">

		#{ifErrors}
		<p class="error">
			${errors[0]}
		</p>
		#{/ifErrors}

		<ol>
			<li>
				<label for="author">
					Dein Name
					<span class="red">*</span>
				</label>
				<input type="text" class="text" name="author" id="author" value="${params.author}" />
			</li>
			<li>
				<label for="content">
					Deine Nachricht
					<span class="red">*</span>
				</label>
				<textarea name="content" rows="6" cols="50" id="content">${params.content}</textarea>
			</li>
			<li>
				<img width="150" height="50" alt="Captcha" src="@{Application.captcha(randomID)}" />
				<br />
				<input type="text" name="code" id="code" class="text" size="18" value="" />
				<input type="hidden" name="randomID" value="${randomID}" />
			</li>
			<li class="buttons">
				<input type="image" name="imageField" alt="Formular Absenden" title="Kommentar Senden" id="imageField" src="@{'/public/images/send.gif'}" class="send">
				<div class="clr">
				</div>
			</li>
		</ol>
	</form>
</div>
<script>
	$( function() {
		// Expose the form
		$('form').click( function() {
			$('form').expose({api: true}).load();
		});
		// If there is an error, focus to form
		if($('form .error').size()) {
			$('form').expose({api: true, loadSpeed: 0}).load();
			$('form input[type=text]').get(0).focus();
		}
	});
</script>